<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SalinWika - Learn. Speak. Connect Generations. üáµüá≠</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;500;600;700;800;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #3498DB 0%, #1ABC9C 50%, #F1C40F 100%);
            min-height: 100vh;
            color: #2d3748;
            overflow-x: hidden;
        }
        
        .floating-shapes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .shape {
            position: absolute;
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }
        
        .shape:nth-child(1) {
            width: 80px;
            height: 80px;
            background: rgba(241, 196, 15, 0.3);
            top: 10%;
            left: 10%;
            animation-delay: 0s;
        }
        
        .shape:nth-child(2) {
            width: 60px;
            height: 60px;
            background: rgba(26, 188, 156, 0.3);
            top: 20%;
            right: 10%;
            animation-delay: 2s;
        }
        
        .shape:nth-child(3) {
            width: 100px;
            height: 100px;
            background: rgba(193, 154, 107, 0.3);
            bottom: 20%;
            left: 5%;
            animation-delay: 4s;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 2;
        }
        
        .header {
            text-align: center;
            background: linear-gradient(135deg, #FEF9F3 0%, #ffffff 100%);
            padding: 40px;
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(193, 154, 107, 0.2);
            margin-bottom: 30px;
            border: 3px solid #C19A6B;
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            background: linear-gradient(135deg, #F1C40F, #C19A6B, #1ABC9C);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 3.5rem;
            font-weight: 900;
            margin-bottom: 15px;
            text-shadow: 0 4px 8px rgba(193, 154, 107, 0.3);
        }
        
        .header p {
            color: #C19A6B;
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .lesson-selector {
            background: linear-gradient(135deg, #FEF9F3 0%, #ffffff 100%);
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 15px 40px rgba(193, 154, 107, 0.15);
            border: 2px solid #D8BFAA;
        }
        
        .lesson-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .lesson-card {
            background: linear-gradient(135deg, #ffffff, #FEF9F3);
            border-radius: 20px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid #E5E5E5;
            text-align: center;
            box-shadow: 0 8px 25px rgba(193, 154, 107, 0.1);
        }
        
        .lesson-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 50px rgba(241, 196, 15, 0.2);
            border-color: #FFE066;
        }
        
        .lesson-card.active {
            border-color: #F1C40F;
            background: linear-gradient(135deg, #F1C40F, #FFE066);
            color: white;
            box-shadow: 0 15px 40px rgba(241, 196, 15, 0.4);
        }
        
        .lesson-emoji {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        .lesson-name {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .lesson-description {
            font-size: 1rem;
            opacity: 0.8;
        }
        
        .progress-bar {
            background: linear-gradient(135deg, #FEF9F3, #ffffff);
            border-radius: 25px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(193, 154, 107, 0.15);
            border: 2px solid #D8BFAA;
        }
        
        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .lesson-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #C19A6B;
        }
        
        .stars {
            display: flex;
            gap: 5px;
        }
        
        .star {
            font-size: 1.5rem;
            color: #E74C3C;
            animation: sparkle 2s ease-in-out infinite;
        }
        
        @keyframes sparkle {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        
        .progress-track {
            background: #E5E5E5;
            height: 12px;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, #2ECC71, #1ABC9C);
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
        }
        
        .lesson-nav {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .lesson-step {
            padding: 15px 25px;
            background: linear-gradient(135deg, #FEF9F3, #E5E5E5);
            border: 2px solid #D8BFAA;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 700;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(193, 154, 107, 0.15);
            position: relative;
            overflow: hidden;
            color: #C19A6B;
        }
        
        .lesson-step:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(241, 196, 15, 0.3);
            border-color: #F1C40F;
        }
        
        .lesson-step.active {
            background: linear-gradient(135deg, #1ABC9C, #4DD0E1);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(26, 188, 156, 0.4);
            border-color: #1ABC9C;
        }
        
        .lesson-step.completed {
            background: linear-gradient(135deg, #2ECC71, #1ABC9C);
            color: white;
            border-color: #2ECC71;
        }
        
        .lesson-content {
            background: linear-gradient(135deg, #FEF9F3 0%, #ffffff 100%);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 15px 40px rgba(193, 154, 107, 0.1);
            margin-bottom: 25px;
            border: 2px solid #D8BFAA;
            min-height: 500px;
        }
        
        .step-content {
            display: none;
            animation: fadeInUp 0.5s ease;
        }
        
        .step-content.active {
            display: block;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .intro-section {
            text-align: center;
            margin: 30px 0;
        }
        
        .intro-emoji {
            font-size: 8rem;
            margin: 30px 0;
            animation: bounce 2s ease-in-out infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        
        .intro-text {
            font-size: 1.4rem;
            color: #C19A6B;
            line-height: 1.8;
            margin: 20px 0;
            font-weight: 500;
        }
        
        .vocabulary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        
        .vocab-card {
            background: linear-gradient(135deg, #ffffff, #FEF9F3);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(193, 154, 107, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid #D8BFAA;
            position: relative;
        }
        
        .vocab-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 20px 50px rgba(26, 188, 156, 0.2);
            border-color: #1ABC9C;
        }
        
        .vocab-emoji {
            font-size: 4rem;
            margin-bottom: 15px;
        }
        
        .vocab-english {
            font-size: 1.3rem;
            font-weight: 700;
            margin: 10px 0;
            color: #C19A6B;
        }
        
        .vocab-filipino {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1ABC9C;
            margin-bottom: 15px;
        }
        
        .play-sound {
            background: linear-gradient(135deg, #E74C3C, #C0392B);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }
        
        .play-sound:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.5);
            background: linear-gradient(135deg, #C0392B, #E74C3C);
        }
        
        .edit-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #1ABC9C;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }
        
        .edit-btn:hover {
            background: #16A085;
            transform: scale(1.1);
        }
        
        .add-word-section {
            background: linear-gradient(135deg, #2ECC71, rgba(46, 204, 113, 0.1));
            border-radius: 20px;
            padding: 25px;
            margin: 30px 0;
            border: 2px dashed #2ECC71;
            text-align: center;
        }
        
        .add-word-btn {
            background: linear-gradient(135deg, #2ECC71, #27AE60);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 20px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(46, 204, 113, 0.3);
        }
        
        .add-word-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(46, 204, 113, 0.4);
        }
        
        .game-area {
            background: linear-gradient(135deg, #FEF9F3, #7EC8E3);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            border: 3px dashed #3498DB;
            box-shadow: 0 10px 30px rgba(52, 152, 219, 0.15);
        }
        
        .game-question {
            font-size: 1.8rem;
            font-weight: 700;
            text-align: center;
            color: #C19A6B;
            margin-bottom: 25px;
        }
        
        .matching-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }
        
        .matching-column {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            padding: 20px;
        }
        
        .matching-column h3 {
            text-align: center;
            color: #C19A6B;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }
        
        .match-item {
            background: white;
            border: 3px solid #D8BFAA;
            border-radius: 15px;
            padding: 15px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .match-item:hover {
            transform: scale(1.05);
            border-color: #1ABC9C;
        }
        
        .match-item.selected {
            border-color: #F1C40F;
            background: #FFE066;
            color: white;
        }
        
        .match-item.correct {
            border-color: #2ECC71;
            background: #2ECC71;
            color: white;
        }
        
        .game-options {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .game-option {
            padding: 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid #D8BFAA;
            background: linear-gradient(135deg, #ffffff, #FEF9F3);
            text-align: center;
            min-width: 120px;
            font-size: 1.2rem;
            font-weight: 600;
            color: #C19A6B;
            box-shadow: 0 6px 20px rgba(193, 154, 107, 0.1);
        }
        
        .game-option:hover {
            transform: scale(1.1);
            border-color: #1ABC9C;
            box-shadow: 0 10px 30px rgba(26, 188, 156, 0.2);
        }
        
        .phrases-section {
            margin: 30px 0;
        }
        
        .phrase-card {
            background: linear-gradient(135deg, #ffffff, #FEF9F3);
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 8px 25px rgba(193, 154, 107, 0.1);
            border-left: 5px solid #1ABC9C;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .phrase-card:hover {
            transform: translateX(10px);
            box-shadow: 0 12px 35px rgba(26, 188, 156, 0.2);
            border-left-color: #F1C40F;
        }
        
        .phrase-english {
            font-size: 1.2rem;
            color: #C19A6B;
            margin-bottom: 8px;
        }
        
        .phrase-filipino {
            font-size: 1.4rem;
            font-weight: 700;
            color: #1ABC9C;
        }
        
        .song-section {
            background: linear-gradient(135deg, #F1C40F, #FFE066);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            margin: 20px 0;
            box-shadow: 0 15px 40px rgba(241, 196, 15, 0.3);
        }
        
        .song-title {
            font-size: 2rem;
            font-weight: 800;
            color: white;
            margin-bottom: 20px;
            text-shadow: 0 2px 4px rgba(193, 154, 107, 0.5);
        }
        
        .song-lyrics {
            font-size: 1.5rem;
            font-weight: 600;
            color: white;
            line-height: 2;
            margin: 20px 0;
            text-shadow: 0 1px 3px rgba(193, 154, 107, 0.3);
        }
        
        .play-song {
            background: linear-gradient(135deg, #E74C3C, #C0392B);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.4);
        }
        
        .play-song:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(231, 76, 60, 0.5);
        }
        
        .parent-guide {
            background: linear-gradient(135deg, #2ECC71, rgba(46, 204, 113, 0.1));
            border-radius: 20px;
            padding: 25px;
            margin: 30px 0;
            border-left: 5px solid #2ECC71;
            box-shadow: 0 10px 30px rgba(46, 204, 113, 0.15);
        }
        
        .parent-guide h3 {
            color: white;
            margin-bottom: 15px;
            font-size: 1.4rem;
        }
        
        .parent-guide p {
            color: white;
            line-height: 1.6;
            margin-bottom: 10px;
        }
        
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .nav-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }
        
        .prev-btn {
            background: linear-gradient(135deg, #3498DB, #7EC8E3);
            color: white;
        }
        
        .next-btn {
            background: linear-gradient(135deg, #2ECC71, #1ABC9C);
            color: white;
        }
        
        .nav-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.2);
        }
        
        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .practice-button {
            background: linear-gradient(135deg, #E74C3C, #C0392B);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.3);
        }
        
        .practice-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(231, 76, 60, 0.4);
        }
        
        .memory-boost {
            background: linear-gradient(135deg, #F1C40F, rgba(255, 224, 102, 0.3));
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid #FFE066;
            box-shadow: 0 10px 30px rgba(241, 196, 15, 0.2);
        }
        
        .memory-boost h3 {
            color: white;
            margin-bottom: 15px;
            font-size: 1.4rem;
        }
        
        .memory-boost p {
            color: white;
            line-height: 1.6;
            margin-bottom: 15px;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background: linear-gradient(135deg, #FEF9F3, #ffffff);
            margin: 10% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .modal h3 {
            color: #C19A6B;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .modal input {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid #D8BFAA;
            border-radius: 10px;
            font-size: 1.1rem;
        }
        
        .modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .modal-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .save-btn {
            background: linear-gradient(135deg, #2ECC71, #27AE60);
            color: white;
        }
        
        .cancel-btn {
            background: linear-gradient(135deg, #95A5A6, #7F8C8D);
            color: white;
        }
        
        @media (max-width: 768px) {
            .vocabulary-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .lesson-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .lesson-nav {
                flex-direction: column;
            }
            
            .matching-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="floating-shapes">
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
    </div>
    
    <!-- Edit Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <h3>‚úèÔ∏è Edit Word/Phrase</h3>
            <input type="text" id="editEnglish" placeholder="English word/phrase">
            <input type="text" id="editFilipino" placeholder="Filipino translation">
            <input type="text" id="editDialect" placeholder="Your dialect translation (optional)">
            <input type="text" id="editEmoji" placeholder="Emoji (optional)">
            <div class="modal-buttons">
                <button class="modal-btn save-btn" onclick="saveEdit()">üíæ Save</button>
                <button class="modal-btn cancel-btn" onclick="closeModal()">‚ùå Cancel</button>
            </div>
        </div>
    </div>
    
    <!-- Add Word Modal -->
    <div id="addModal" class="modal">
        <div class="modal-content">
            <h3>‚ûï Add New Word/Phrase</h3>
            <input type="text" id="addEnglish" placeholder="English word/phrase">
            <input type="text" id="addFilipino" placeholder="Filipino translation">
            <input type="text" id="addDialect" placeholder="Your dialect translation (optional)">
            <input type="text" id="addEmoji" placeholder="Emoji (optional)">
            <div class="modal-buttons">
                <button class="modal-btn save-btn" onclick="addNewWord()">‚ûï Add</button>
                <button class="modal-btn cancel-btn" onclick="closeModal()">‚ùå Cancel</button>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="header">
            <h1>üåü SalinWika üåü</h1>
            <p>Play. Speak. Celebrate Filipino! üöÄ‚ú®</p>
        </div>
        
        <div class="lesson-selector">
            <h2 style="text-align: center; margin-bottom: 20px; font-size: 2rem; color: #C19A6B;">Choose Your Lesson</h2>
            <div class="lesson-grid">
                <div class="lesson-card active" onclick="selectLesson(1)">
                    <div class="lesson-emoji">üåà</div>
                    <div class="lesson-name">Colors</div>
                    <div class="lesson-description">Mga Kulay</div>
                </div>
                <div class="lesson-card" onclick="selectLesson(2)">
                    <div class="lesson-emoji">üî¢</div>
                    <div class="lesson-name">Numbers</div>
                    <div class="lesson-description">Mga Numero</div>
                </div>
                <div class="lesson-card" onclick="selectLesson(3)">
                    <div class="lesson-emoji">üêæ</div>
                    <div class="lesson-name">Animals</div>
                    <div class="lesson-description">Mga Hayop</div>
                </div>
                <div class="lesson-card" onclick="selectLesson(4)">
                    <div class="lesson-emoji">üçé</div>
                    <div class="lesson-name">Food</div>
                    <div class="lesson-description">Mga Pagkain</div>
                </div>
                <div class="lesson-card" onclick="selectLesson(5)">
                    <div class="lesson-emoji">üë§</div>
                    <div class="lesson-name">Body Parts</div>
                    <div class="lesson-description">Mga Bahagi ng Katawan</div>
                </div>
                <div class="lesson-card" onclick="selectLesson(6)">
                    <div class="lesson-emoji">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
                    <div class="lesson-name">Family</div>
                    <div class="lesson-description">Pamilya</div>
                </div>
                <div class="lesson-card" onclick="selectLesson(7)">
                    <div class="lesson-emoji">üí¨</div>
                    <div class="lesson-name">Daily Words</div>
                    <div class="lesson-description">Araw-araw</div>
                </div>
                <div class="lesson-card" onclick="selectLesson(8)">
                    <div class="lesson-emoji">üéÆ</div>
                    <div class="lesson-name">Filipino Games</div>
                    <div class="lesson-description">Mga Laro</div>
                </div>
            </div>
        </div>
        
        <div class="progress-bar">
            <div class="progress-info">
                <div class="lesson-title" id="current-lesson-title">Lesson 1: Mga Kulay (Colors)</div>
                <div class="stars">
                    <span class="star">‚≠ê</span>
                    <span class="star">‚≠ê</span>
                    <span class="star">‚≠ê</span>
                </div>
            </div>
            <div class="progress-track">
                <div class="progress-fill" id="progress-fill" style="width: 16.67%"></div>
            </div>
        </div>
        
        <div class="lesson-nav">
            <button class="lesson-step active" onclick="showStep(1)">üéß Listen & Learn</button>
            <button class="lesson-step" onclick="showStep(2)">üìö See & Hear</button>
            <button class="lesson-step" onclick="showStep(3)">üéÆ Play & Match</button>
            <button class="lesson-step" onclick="showStep(4)">üí¨ Daily Talk</button>
            <button class="lesson-step" onclick="showStep(5)">üéµ Sing Along</button>
            <button class="lesson-step" onclick="showStep(6)">üèÜ Practice More</button>
        </div>
        
        <div class="lesson-content" id="lesson-content">
            <!-- Dynamic content will be loaded here -->
        </div>
        
        <div class="navigation-buttons">
            <button class="nav-btn prev-btn" onclick="previousStep()" id="prev-btn" disabled>‚Üê Previous</button>
            <button class="nav-btn next-btn" onclick="nextStep()" id="next-btn">Next ‚Üí</button>
        </div>
    </div>
    
    <script>
        let currentLesson = 1;
        let currentStep = 1;
        let currentEditIndex = -1;
        let currentEditType = '';
        let matchingGame = {
            selectedLeft: null,
            selectedRight: null,
            matches: 0,
            total: 0
        };
        
        // Autosave and restore functionality
        function saveToLocalStorage() {
            try {
                const saveData = {
                    lessons: lessons,
                    currentLesson: currentLesson,
                    currentStep: currentStep,
                    timestamp: new Date().toISOString()
                };
                localStorage.setItem('salinwika_data', JSON.stringify(saveData));
                console.log('‚úÖ Data saved automatically!');
            } catch (error) {
                console.error('‚ùå Failed to save data:', error);
            }
        }
        
        function loadFromLocalStorage() {
            try {
                const savedData = localStorage.getItem('salinwika_data');
                if (savedData) {
                    const data = JSON.parse(savedData);
                    lessons = data.lessons || lessons;
                    currentLesson = data.currentLesson || 1;
                    currentStep = data.currentStep || 1;
                    console.log('‚úÖ Data restored from previous session!');
                    return true;
                }
            } catch (error) {
                console.error('‚ùå Failed to load saved data:', error);
            }
            return false;
        }
        
        // Auto-save every 30 seconds
        setInterval(saveToLocalStorage, 30000);
        
        // Lesson data structure (now editable)
        let lessons = {
            1: {
                title: "Lesson 1: Mga Kulay (Colors)",
                emoji: "üåà",
                vocabulary: [
                    { english: "Red", filipino: "Pula", emoji: "üçé" },
                    { english: "Blue", filipino: "Asul", emoji: "üåä" },
                    { english: "Green", filipino: "Berde", emoji: "üåø" },
                    { english: "Black", filipino: "Itim", emoji: "üê±" },
                    { english: "White", filipino: "Puti", emoji: "ü•õ" }
                ],
                phrases: [
                    { english: "My dress is red.", filipino: "Pula ang damit ko." },
                    { english: "The sea is blue.", filipino: "Asul ang dagat." },
                    { english: "The grass is green.", filipino: "Berde ang damo." },
                    { english: "What color is this?", filipino: "Anong kulay ito?" },
                    { english: "I like red.", filipino: "Gusto ko ang pula." }
                ],
                song: {
                    title: "Color Song",
                    lyrics: "Pula, asul, berde rin,<br>Itim, puti, mga kulay natin...<br>Matuto tayo ng mga kulay,<br>Sa Filipino, masaya!"
                }
            },
            2: {
                title: "Lesson 2: Mga Numero (Numbers)",
                emoji: "üî¢",
                vocabulary: [
                    { english: "One", filipino: "Isa", emoji: "1Ô∏è‚É£" },
                    { english: "Two", filipino: "Dalawa", emoji: "2Ô∏è‚É£" },
                    { english: "Three", filipino: "Tatlo", emoji: "3Ô∏è‚É£" },
                    { english: "Four", filipino: "Apat", emoji: "4Ô∏è‚É£" },
                    { english: "Five", filipino: "Lima", emoji: "5Ô∏è‚É£" }
                ],
                phrases: [
                    { english: "I have one apple.", filipino: "May isang mansanas ako." },
                    { english: "Two cats are playing.", filipino: "Dalawang pusa ang naglalaro." },
                    { english: "Count to five.", filipino: "Bilangin hanggang lima." },
                    { english: "How many?", filipino: "Ilan?" },
                    { english: "I am five years old.", filipino: "Limang taon na ako." }
                ],
                song: {
                    title: "Counting Song",
                    lyrics: "Isa, dalawa, tatlo pa,<br>Apat, lima, bilang na!<br>Matuto tayo mag-bilang,<br>Sa Filipino, masayang!"
                }
            },
            3: {
                title: "Lesson 3: Mga Hayop (Animals)",
                emoji: "üêæ",
                vocabulary: [
                    { english: "Dog", filipino: "Aso", emoji: "üêï" },
                    { english: "Cat", filipino: "Pusa", emoji: "üê±" },
                    { english: "Bird", filipino: "Ibon", emoji: "üê¶" },
                    { english: "Fish", filipino: "Isda", emoji: "üêü" },
                    { english: "Cow", filipino: "Baka", emoji: "üêÑ" }
                ],
                phrases: [
                    { english: "The dog is barking.", filipino: "Tumatahol ang aso." },
                    { english: "I see a bird.", filipino: "Nakakita ako ng ibon." },
                    { english: "The cat is sleeping.", filipino: "Natutulog ang pusa." },
                    { english: "Fish swim in water.", filipino: "Lumalangoy ang isda sa tubig." },
                    { english: "I love animals.", filipino: "Mahal ko ang mga hayop." }
                ],
                song: {
                    title: "Animal Song",
                    lyrics: "Aso, pusa, ibon din,<br>Isda, baka, mga kaibigan...<br>Mga hayop ay masaya,<br>Alagaan natin sila!"
                }
            },
            4: {
                title: "Lesson 4: Mga Pagkain (Food)",
                emoji: "üçé",
                vocabulary: [
                    { english: "Rice", filipino: "Kanin", emoji: "üçö" },
                    { english: "Fish", filipino: "Isda", emoji: "üêü" },
                    { english: "Banana", filipino: "Saging", emoji: "üçå" },
                    { english: "Mango", filipino: "Mangga", emoji: "ü•≠" },
                    { english: "Bread", filipino: "Tinapay", emoji: "üçû" }
                ],
                phrases: [
                    { english: "I want to eat rice.", filipino: "Gusto kong kumain ng kanin." },
                    { english: "The mango is sweet.", filipino: "Matamis ang mangga." },
                    { english: "Have you eaten?", filipino: "Kumain ka na ba?" },
                    { english: "I'm hungry.", filipino: "Gutom na ako." },
                    { english: "This is delicious.", filipino: "Masarap ito." }
                ],
                song: {
                    title: "Food Song",
                    lyrics: "Kanin, isda, saging pa,<br>Mangga, tinapay, masarap na!<br>Kumain tayo ng masustansya,<br>Para maging malakas ka!"
                }
            },
            5: {
                title: "Lesson 5: Mga Bahagi ng Katawan (Body Parts)",
                emoji: "üë§",
                vocabulary: [
                    { english: "Head", filipino: "Ulo", emoji: "üë§" },
                    { english: "Eyes", filipino: "Mata", emoji: "üëÄ" },
                    { english: "Nose", filipino: "Ilong", emoji: "üëÉ" },
                    { english: "Mouth", filipino: "Bibig", emoji: "üëÑ" },
                    { english: "Hands", filipino: "Kamay", emoji: "‚úã" }
                ],
                phrases: [
                    { english: "Touch your head.", filipino: "Hawakan ang ulo mo." },
                    { english: "Close your eyes.", filipino: "Pikit ang mata mo." },
                    { english: "Open your mouth.", filipino: "Buksan ang bibig mo." },
                    { english: "Clap your hands.", filipino: "Palakpakan ang kamay mo." },
                    { english: "My nose is small.", filipino: "Maliit ang ilong ko." }
                ],
                song: {
                    title: "Body Parts Song",
                    lyrics: "Ulo, mata, ilong din,<br>Bibig, kamay, mga bahagi natin...<br>Alagaan natin ang katawan,<br>Para maging malusog tayo!"
                }
            },
            6: {
                title: "Lesson 6: Pamilya (Family)",
                emoji: "üë®‚Äçüë©‚Äçüëß‚Äçüë¶",
                vocabulary: [
                    { english: "Mother", filipino: "Nanay", emoji: "üë©" },
                    { english: "Father", filipino: "Tatay", emoji: "üë®" },
                    { english: "Sister", filipino: "Ate", emoji: "üëß" },
                    { english: "Brother", filipino: "Kuya", emoji: "üë¶" },
                    { english: "Grandmother", filipino: "Lola", emoji: "üëµ" }
                ],
                phrases: [
                    { english: "I love my family.", filipino: "Mahal ko ang pamilya ko." },
                    { english: "Where is mother?", filipino: "Nasaan si Nanay?" },
                    { english: "Father is working.", filipino: "Nagtatrabaho si Tatay." },
                    { english: "My sister is kind.", filipino: "Mabait ang ate ko." },
                    { english: "Grandmother tells stories.", filipino: "Nagkukuwento si Lola." }
                ],
                song: {
                    title: "Family Song",
                    lyrics: "Nanay, Tatay, Ate, Kuya,<br>Lola, Lolo, pamilya niya...<br>Mahal namin ang isa't isa,<br>Pamilya ay kayamanan!"
                }
            },
            7: {
                title: "Lesson 7: Araw-araw (Daily Words)",
                emoji: "üí¨",
                vocabulary: [
                    { english: "Hello", filipino: "Kumusta", emoji: "üëã" },
                    { english: "Thank you", filipino: "Salamat", emoji: "üôè" },
                    { english: "Please", filipino: "Pakisuyo", emoji: "ü§≤" },
                    { english: "Sorry", filipino: "Pasensya", emoji: "üòî" },
                    { english: "Goodbye", filipino: "Paalam", emoji: "üëã" }
                ],
                phrases: [
                    { english: "Good morning!", filipino: "Magandang umaga!" },
                    { english: "How are you?", filipino: "Kumusta ka?" },
                    { english: "Let's play!", filipino: "Laro tayo!" },
                    { english: "I'm thirsty.", filipino: "Nauuhaw ako." },
                    { english: "Help me please.", filipino: "Tulungan mo ako." }
                ],
                song: {
                    title: "Daily Words Song",
                    lyrics: "Kumusta, salamat, pakisuyo,<br>Pasensya, paalam, araw-araw mo...<br>Mga salitang ginagamit,<br>Sa bawat araw, tandaan natin!"
                }
            },
            8: {
                title: "Lesson 8: Mga Laro (Filipino Games)",
                emoji: "üéÆ",
                vocabulary: [
                    { english: "Patintero", filipino: "Patintero", emoji: "üèÉ" },
                    { english: "Hide and Seek", filipino: "Taguan", emoji: "üëÅÔ∏è" },
                    { english: "Tag", filipino: "Habulan", emoji: "üèÉ‚Äç‚ôÇÔ∏è" },
                    { english: "Jump Rope", filipino: "Luksong Lubid", emoji: "ü™¢" },
                    { english: "Hopscotch", filipino: "Piko", emoji: "‚¨ú" }
                ],
                phrases: [
                    { english: "Let's play patintero!", filipino: "Maglaro tayo ng patintero!" },
                    { english: "You're it!", filipino: "Ikaw ang taya!" },
                    { english: "I found you!", filipino: "Nakita kita!" },
                    { english: "My turn to hide.", filipino: "Ako naman ang magtago." },
                    { english: "Games are fun!", filipino: "Masaya ang mga laro!" }
                ],
                song: {
                    title: "Games Song",
                    lyrics: "Patintero, taguan din,<br>Habulan, piko, mga laro natin...<br>Maglaro tayo ng masaya,<br>Mga kaibigan, samahan mo!"
                }
            }
        };
        
        // Enhanced Audio System with Filipino Accent Priority
        function speakText(text, lang = 'tl-PH') {
            if ('speechSynthesis' in window) {
                speechSynthesis.cancel();
                
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'tl-PH'; // Filipino language
                utterance.rate = 0.6; // Even slower for clear pronunciation
                utterance.pitch = 1.4; // Higher pitch for female voice
                utterance.volume = 1.0;
                
                // Prioritize Filipino/Tagalog voices first
                const voices = speechSynthesis.getVoices();
                let selectedVoice = voices.find(voice => 
                    voice.lang === 'tl-PH' || voice.lang === 'fil-PH' || voice.lang.includes('tl')
                );
                
                // If no Filipino voice, try to find Asian English voices (closer accent)
                if (!selectedVoice) {
                    selectedVoice = voices.find(voice => 
                        voice.name.toLowerCase().includes('asia') || 
                        voice.name.toLowerCase().includes('indian') ||
                        voice.name.toLowerCase().includes('singapore') ||
                        (voice.name.toLowerCase().includes('female') && voice.lang.includes('en-IN'))
                    );
                }
                
                // Last resort: any female voice
                if (!selectedVoice) {
                    selectedVoice = voices.find(voice => 
                        voice.name.toLowerCase().includes('female') || 
                        voice.name.toLowerCase().includes('woman')
                    );
                }
                
                if (selectedVoice) {
                    utterance.voice = selectedVoice;
                }
                
                speechSynthesis.speak(utterance);
                return true;
            }
            return false;
        }
        
        function selectLesson(lessonNumber) {
            currentLesson = lessonNumber;
            currentStep = 1;
            
            // Update lesson selector
            document.querySelectorAll('.lesson-card').forEach(card => {
                card.classList.remove('active');
            });
            document.querySelectorAll('.lesson-card')[lessonNumber - 1].classList.add('active');
            
            // Update lesson title
            document.getElementById('current-lesson-title').textContent = lessons[lessonNumber].title;
            
            // Load lesson content
            loadLessonContent();
            updateProgress();
            updateNavigationButtons();
            saveToLocalStorage(); // Auto-save when lesson changes
        }
        
        function loadLessonContent() {
            const lesson = lessons[currentLesson];
            const content = document.getElementById('lesson-content');
            
            content.innerHTML = `
                <!-- Step 1: Introduction -->
                <div class="step-content active" id="step-1">
                    <div class="intro-section">
                        <div class="intro-emoji">${lesson.emoji}</div>
                        <div class="intro-text">
                            <strong>Hi there! Welcome to ${lesson.title}! üéâ</strong><br>
                            Let's have fun learning Filipino words and stories! üåû<br>
                            Tap, play, and speak your way through games. Every word you learn helps you connect with your family and culture! üìö<br>
                            Ready to start? Let's go! üöÄ
                        </div>
                        <button class="play-sound" onclick="playIntroAudio()">üîä Listen to Introduction</button>
                    </div>
                </div>
                
                <!-- Step 2: Vocabulary -->
                <div class="step-content" id="step-2">
                    <h2 style="text-align: center; margin-bottom: 30px; font-size: 2.5rem; color: #C19A6B;">üìö Learn New Words</h2>
                    
                    <div class="add-word-section">
                        <h3 style="color: #2ECC71; margin-bottom: 15px;">‚ûï Add Your Own Words</h3>
                        <p style="color: #C19A6B; margin-bottom: 20px;">Want to learn more words? Add your own vocabulary!</p>
                        <button class="add-word-btn" onclick="openAddModal('vocabulary')">‚ûï Add New Word</button>
                    </div>
                    
                    <div class="vocabulary-grid" id="vocab-grid">
                        ${lesson.vocabulary.map((item, index) => `
                            <div class="vocab-card" onclick="playVocabSound('${item.filipino}')">
                                <button class="edit-btn" onclick="editItem('vocabulary', ${index})" title="Edit">‚úèÔ∏è</button>
                                <div class="vocab-emoji">${item.emoji}</div>
                                <div class="vocab-english">${item.english}</div>
                                <div class="vocab-filipino">${item.filipino}</div>
                                ${item.dialect ? `<div class="vocab-dialect" style="font-size: 0.9rem; color: #E74C3C; font-weight: 500; margin: 5px 0;">${item.dialect}</div>` : ''}
                                <button class="play-sound">üîä Play</button>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <!-- Step 3: Matching Game -->
                <div class="step-content" id="step-3">
                    <div class="game-area">
                        <div class="game-question">üéØ Match the English words with Filipino translations!</div>
                        <div class="matching-container" id="matching-container">
                            <div class="matching-column">
                                <h3>üá∫üá∏ English</h3>
                                <div id="english-items">
                                    ${lesson.vocabulary.slice(0, 4).map((item, index) => `
                                        <div class="match-item" data-type="english" data-value="${item.english}" onclick="selectMatchItem(this)">
                                            ${item.emoji} ${item.english}
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            <div class="matching-column">
                                <h3>üáµüá≠ Filipino</h3>
                                <div id="filipino-items">
                                    ${lesson.vocabulary.slice(0, 4).sort(() => Math.random() - 0.5).map((item, index) => `
                                        <div class="match-item" data-type="filipino" data-value="${item.filipino}" data-english="${item.english}" onclick="selectMatchItem(this)">
                                            ${item.filipino}
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 20px;">
                            <div id="game-feedback" style="font-size: 1.5rem; font-weight: 700; margin: 15px 0;"></div>
                            <div id="game-score" style="color: #C19A6B;">Matches: <span id="score">${matchingGame.matches}</span>/${lesson.vocabulary.slice(0, 4).length}</div>
                            <button class="practice-button" onclick="resetMatchingGame()" style="margin-top: 15px;">üîÑ Reset Game</button>
                        </div>
                    </div>
                </div>
                
                <!-- Step 4: Phrases -->
                <div class="step-content" id="step-4">
                    <h2 style="text-align: center; margin-bottom: 30px; font-size: 2.5rem; color: #C19A6B;">üí¨ Useful Phrases</h2>
                    
                    <div class="parent-guide">
                        <h3>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Parent Guide</h3>
                        <p><strong>Practice at home:</strong> Use these phrases during daily activities. Encourage your child to respond in Filipino.</p>
                        <p><strong>Make it fun:</strong> Turn phrase practice into role-playing games or daily conversations.</p>
                    </div>
                    
                    <div class="add-word-section">
                        <h3 style="color: #2ECC71; margin-bottom: 15px;">‚ûï Add Your Own Phrases</h3>
                        <p style="color: #C19A6B; margin-bottom: 20px;">Add phrases your family uses every day!</p>
                        <button class="add-word-btn" onclick="openAddModal('phrases')">‚ûï Add New Phrase</button>
                    </div>
                    
                    <div class="phrases-section">
                        ${lesson.phrases.map((phrase, index) => `
                            <div class="phrase-card" onclick="speakText('${phrase.filipino}')">
                                <button class="edit-btn" onclick="editItem('phrases', ${index})" title="Edit">‚úèÔ∏è</button>
                                <div class="phrase-english">${phrase.english}</div>
                                <div class="phrase-filipino">${phrase.filipino}</div>
                                ${phrase.dialect ? `<div class="phrase-dialect" style="font-size: 1rem; color: #E74C3C; font-weight: 500; margin: 5px 0; font-style: italic;">${phrase.dialect}</div>` : ''}
                                <button class="play-sound" style="margin-top: 10px;">üîä Listen</button>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <!-- Step 5: Song -->
                <div class="step-content" id="step-5">
                    <div class="song-section">
                        <div class="song-title">üéµ ${lesson.song.title}</div>
                        <div class="song-lyrics">${lesson.song.lyrics}</div>
                        <button class="play-song" onclick="playSong()">üéµ Play Song</button>
                    </div>
                </div>
                
                <!-- Step 6: Review -->
                <div class="step-content" id="step-6">
                    <h2 style="text-align: center; margin-bottom: 30px; font-size: 2.5rem; color: #C19A6B;">üèÜ Practice & Review</h2>
                    
                    <div class="memory-boost">
                        <h3>üß† Memory Boost</h3>
                        <p>Practice these words every day for 5 minutes. Repetition helps you remember better!</p>
                        <button onclick="startSpacedPractice()" class="practice-button">
                            üîÑ Start Practice Session
                        </button>
                    </div>
                    
                    <div class="vocabulary-grid">
                        ${lesson.vocabulary.map(item => `
                            <div class="vocab-card" onclick="reviewWord('${item.filipino}')">
                                <div class="vocab-emoji">${item.emoji}</div>
                                <div class="vocab-filipino">${item.filipino}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <div style="font-size: 2rem; margin: 20px 0;">üéâ Congratulations! üéâ</div>
                        <div style="font-size: 1.3rem; color: #C19A6B;">You've completed ${lesson.title}!</div>
                        <div style="margin: 20px 0;">
                            <span style="font-size: 2rem; color: #E74C3C;">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                        </div>
                    </div>
                </div>
            `;
            
            // Initialize matching game
            matchingGame = {
                selectedLeft: null,
                selectedRight: null,
                matches: 0,
                total: lesson.vocabulary.slice(0, 4).length
            };
            
            showStep(1);
        }
        
        function showStep(step) {
            // Hide all steps
            document.querySelectorAll('.step-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all nav buttons
            document.querySelectorAll('.lesson-step').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected step
            const stepElement = document.getElementById(`step-${step}`);
            if (stepElement) {
                stepElement.classList.add('active');
                document.querySelectorAll('.lesson-step')[step - 1].classList.add('active');
                
                // Mark completed steps
                for (let i = 0; i < step - 1; i++) {
                    document.querySelectorAll('.lesson-step')[i].classList.add('completed');
                }
                
                currentStep = step;
                updateProgress();
                updateNavigationButtons();
            }
        }
        
        function updateProgress() {
            const progress = (currentStep / 6) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
        }
        
        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            
            prevBtn.disabled = currentStep === 1;
            nextBtn.disabled = currentStep === 6;
            
            if (currentStep === 6) {
                nextBtn.textContent = "üéâ Complete!";
            } else {
                nextBtn.textContent = "Next ‚Üí";
            }
        }
        
        function previousStep() {
            if (currentStep > 1) {
                showStep(currentStep - 1);
            }
        }
        
        function nextStep() {
            if (currentStep < 6) {
                showStep(currentStep + 1);
            }
        }
        
        // Matching Game Functions
        function selectMatchItem(element) {
            const type = element.dataset.type;
            const value = element.dataset.value;
            
            if (type === 'english') {
                // Clear previous selection
                document.querySelectorAll('[data-type="english"]').forEach(item => {
                    item.classList.remove('selected');
                });
                element.classList.add('selected');
                matchingGame.selectedLeft = element;
            } else {
                // Clear previous selection
                document.querySelectorAll('[data-type="filipino"]').forEach(item => {
                    item.classList.remove('selected');
                });
                element.classList.add('selected');
                matchingGame.selectedRight = element;
            }
            
            // Check for match
            if (matchingGame.selectedLeft && matchingGame.selectedRight) {
                checkMatch();
            }
        }
        
        function checkMatch() {
            const englishValue = matchingGame.selectedLeft.dataset.value;
            const filipinoEnglish = matchingGame.selectedRight.dataset.english;
            
            const feedback = document.getElementById('game-feedback');
            
            if (englishValue === filipinoEnglish) {
                // Correct match
                matchingGame.selectedLeft.classList.add('correct');
                matchingGame.selectedRight.classList.add('correct');
                matchingGame.selectedLeft.onclick = null;
                matchingGame.selectedRight.onclick = null;
                matchingGame.matches++;
                
                const encouragingMessages = [
                    "üéâ You got it! ‚≠ê‚≠ê‚≠ê",
                    "üåü Wow! You just spoke like a Filipino hero!",
                    "üéØ Perfect match! You're amazing!",
                    "‚ú® Great job! Keep going!"
                ];
                feedback.textContent = encouragingMessages[Math.floor(Math.random() * encouragingMessages.length)];
                feedback.style.color = "#2ECC71";
                
                // Play the Filipino word
                speakText(matchingGame.selectedRight.dataset.value);
                
                // Update score
                document.getElementById('score').textContent = matchingGame.matches;
                
                if (matchingGame.matches === matchingGame.total) {
                    setTimeout(() => {
                        feedback.textContent = "üèÜ All matched! Great job!";
                    }, 1500);
                }
            } else {
                // Incorrect match
                feedback.textContent = "ü§ó Try again, you're doing great!";
                feedback.style.color = "#E74C3C";
                
                setTimeout(() => {
                    matchingGame.selectedLeft.classList.remove('selected');
                    matchingGame.selectedRight.classList.remove('selected');
                    feedback.textContent = "";
                }, 1000);
            }
            
            matchingGame.selectedLeft = null;
            matchingGame.selectedRight = null;
        }
        
        function resetMatchingGame() {
            matchingGame.matches = 0;
            document.getElementById('score').textContent = '0';
            document.getElementById('game-feedback').textContent = '';
            
            // Reset all items
            document.querySelectorAll('.match-item').forEach(item => {
                item.classList.remove('selected', 'correct');
                item.onclick = function() { selectMatchItem(this); };
            });
            
            // Shuffle Filipino items
            const filipinoContainer = document.getElementById('filipino-items');
            const items = Array.from(filipinoContainer.children);
            items.sort(() => Math.random() - 0.5);
            items.forEach(item => filipinoContainer.appendChild(item));
        }
        
        // Edit and Add Functions
        function editItem(type, index) {
            event.stopPropagation();
            currentEditType = type;
            currentEditIndex = index;
            
            const lesson = lessons[currentLesson];
            const item = lesson[type][index];
            
            document.getElementById('editEnglish').value = item.english;
            document.getElementById('editFilipino').value = item.filipino;
            document.getElementById('editDialect').value = item.dialect || '';
            document.getElementById('editEmoji').value = item.emoji || '';
            
            document.getElementById('editModal').style.display = 'block';
        }
        
        function openAddModal(type) {
            currentEditType = type;
            currentEditIndex = -1;
            
            document.getElementById('addEnglish').value = '';
            document.getElementById('addFilipino').value = '';
            document.getElementById('addDialect').value = '';
            document.getElementById('addEmoji').value = '';
            
            document.getElementById('addModal').style.display = 'block';
        }
        
        function saveEdit() {
            const english = document.getElementById('editEnglish').value.trim();
            const filipino = document.getElementById('editFilipino').value.trim();
            const dialect = document.getElementById('editDialect').value.trim();
            const emoji = document.getElementById('editEmoji').value.trim();
            
            if (!english || !filipino) {
                alert('Please fill in both English and Filipino fields!');
                return;
            }
            
            const lesson = lessons[currentLesson];
            lesson[currentEditType][currentEditIndex] = {
                english: english,
                filipino: filipino,
                dialect: dialect || '',
                emoji: emoji || 'üìù'
            };
            
            closeModal();
            loadLessonContent();
            showStep(currentStep);
            saveToLocalStorage(); // Auto-save after edit
        }
        
        function addNewWord() {
            const english = document.getElementById('addEnglish').value.trim();
            const filipino = document.getElementById('addFilipino').value.trim();
            const dialect = document.getElementById('addDialect').value.trim();
            const emoji = document.getElementById('addEmoji').value.trim();
            
            if (!english || !filipino) {
                alert('Please fill in both English and Filipino fields!');
                return;
            }
            
            const lesson = lessons[currentLesson];
            lesson[currentEditType].push({
                english: english,
                filipino: filipino,
                dialect: dialect || '',
                emoji: emoji || 'üìù'
            });
            
            closeModal();
            loadLessonContent();
            showStep(currentStep);
            saveToLocalStorage(); // Auto-save after adding
        }
        
        function closeModal() {
            document.getElementById('editModal').style.display = 'none';
            document.getElementById('addModal').style.display = 'none';
        }
        
        // Close modal when clicking outside
        window.onclick = function(event) {
            const editModal = document.getElementById('editModal');
            const addModal = document.getElementById('addModal');
            if (event.target === editModal) {
                editModal.style.display = 'none';
            }
            if (event.target === addModal) {
                addModal.style.display = 'none';
            }
        }
        
        function playIntroAudio() {
            const button = event.target;
            button.textContent = "üîä Playing...";
            button.style.background = "linear-gradient(135deg, #2ECC71, #1ABC9C)";
            
            const lesson = lessons[currentLesson];
            const introText = `Welcome to ${lesson.title}! Let's learn together and have fun!`;
            
            if (speakText(introText, 'en-US')) {
                setTimeout(() => {
                    button.textContent = "üîä Listen to Introduction";
                    button.style.background = "linear-gradient(135deg, #E74C3C, #C0392B)";
                }, 5000);
            }
        }
        
        function playVocabSound(word) {
            const card = event.currentTarget;
            const originalTransform = card.style.transform;
            card.style.transform = "scale(1.1)";
            card.style.boxShadow = "0 25px 60px rgba(26, 188, 156, 0.3)";
            
            speakText(word);
            
            setTimeout(() => {
                card.style.transform = originalTransform;
                card.style.boxShadow = "0 10px 30px rgba(193, 154, 107, 0.1)";
            }, 500);
        }
        
        function playSong() {
            const button = event.target;
            button.textContent = "üéµ Playing...";
            button.style.background = "linear-gradient(135deg, #2ECC71, #1ABC9C)";
            
            const lesson = lessons[currentLesson];
            const songText = lesson.song.lyrics.replace(/<br>/g, ' ');
            speakText(songText);
            
            setTimeout(() => {
                button.textContent = "üéµ Play Song";
                button.style.background = "linear-gradient(135deg, #E74C3C, #C0392B)";
            }, 8000);
        }
        
        function reviewWord(word) {
            const card = event.target;
            const originalTransform = card.style.transform;
            card.style.transform = "scale(1.2)";
            
            speakText(word);
            
            setTimeout(() => {
                card.style.transform = originalTransform;
            }, 300);
        }
        
        function startSpacedPractice() {
            const lesson = lessons[currentLesson];
            const button = event.target;
            button.textContent = "üîÑ Practicing...";
            button.disabled = true;
            
            let index = 0;
            const practiceWords = lesson.vocabulary.map(item => item.filipino);
            
            function practiceNext() {
                if (index >= practiceWords.length) {
                    button.textContent = "‚úÖ Practice Complete!";
                    button.style.background = "linear-gradient(135deg, #2ECC71, #1ABC9C)";
                    
                    setTimeout(() => {
                        button.textContent = "üîÑ Start Practice Session";
                        button.style.background = "linear-gradient(135deg, #E74C3C, #C0392B)";
                        button.disabled = false;
                    }, 3000);
                    return;
                }
                
                speakText(practiceWords[index]);
                index++;
                
                setTimeout(practiceNext, 2000);
            }
            
            practiceNext();
        }
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Try to restore previous session
            const restored = loadFromLocalStorage();
            if (restored) {
                // Update UI to reflect restored state
                selectLesson(currentLesson);
                showStep(currentStep);
                console.log('üéâ Welcome back! Your progress has been restored.');
            } else {
                loadLessonContent();
                updateProgress();
                updateNavigationButtons();
            }
        });
        
        // Load voices when available
        if ('speechSynthesis' in window) {
            speechSynthesis.onvoiceschanged = function() {
                // Voices are now loaded
            };
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'974c4ddc2581ed93',t:'MTc1NjEzNzY0NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
